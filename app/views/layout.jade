doctype html

block vars

- offline       = offline       || false;             // Load HTML5 cache-manifest for this site ?
- webappCapable = webappCapable || offline;
- title         = title         || config.meta.manifest.options.short_name;
- ngApp         = ngApp         || undefined;
- ngController  = ngController  || undefined;
- lang          = lang          || "en";

- viewport              = viewport              || {};
- viewport.width        = viewport.width        || config.meta.viewport.width;
- viewport.initialScale = viewport.initialScale || config.meta.viewport.initialScale;
- viewport.maximumScale = viewport.maximumScale || config.meta.viewport.maximumScale;
- viewport.userScalable = viewport.userScalable || config.meta.viewport.userScalable;

- ms            = ms            || {};
- ms.tileColor  = ms.tileColor  || config.meta.manifest.options.background_color  || "#FFF";
- ms.name       = ms.name       || title;
- ms.tooltip    = ms.tooltip    || config.meta.manifest.options.name              || ms.name;

- cacheManifestUrl    = '/' + config.meta.urlPrefix + '/' + config.meta.offlineCache.cacheManifestFile;
- androidManifestUrl  = '/' + config.meta.urlPrefix + '/' + config.meta.manifest.manifestFile;

- htmlAttrs               = htmlAttrs               || {};
- htmlAttrs.lang          = htmlAttrs.lang          || lang;
- htmlAttrs.ngApp         = htmlAttrs.ngApp         || ngApp;
- htmlAttrs.ngController  = htmlAttrs.ngController  || ngController;
- htmlAttrs.manifest      = htmlAttrs.manifest      || (offline ? cacheManifestUrl : undefined);

html()&attributes(htmlAttrs)

  head
    
    title= title
    meta(charset="utf-8")
    meta(name="viewport" content="width=#{viewport.width}, initial-scale=#{viewport.initialScale}, maximum-scale=#{viewport.maximumScale}, user-scalable=#{viewport.userScalable}")
    
    link(rel="apple-touch-icon" href="/assets/icon/apple-touch-icon.png")
    link(rel="shortcut icon" href="/assets/icon/shortcut-icon.png")
    
    if webappCapable
      meta(name="apple-mobile-web-app-capable" content="yes")
      meta(name="mobile-web-app-capable" content="yes")
      
      // Android pin to start
      
      link(rel="manifest")&attributes({href: androidManifestUrl})
      
    // WindowsPhone pin to start
    // See: https://msdn.microsoft.com/library/dn255024(v=vs.85).aspx
    
    meta(name='msapplication-TileColor', content=ms.tileColor)
    meta(name='msapplication-TileImage', content='/assets/icon/large-icon.png')
    meta(name='msapplication-config', content='none')
    meta(name='application-name', content=ms.name)
    meta(name='msapplication-tooltip', content=ms.tooltip)
    meta(name='msapplication-square70x70logo', content='/assets/icon/pin-icon_70x70.png')
    meta(name='msapplication-square150x150logo', content='/assets/icon/pin-icon_150x150.png')
    meta(name='msapplication-square310x310logo', content='/assets/icon/pin-icon_310x310.png')
    meta(name='msapplication-wide310x150logo', content='/assets/icon/pin-icon_310x150.png')

    <!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    link(rel='stylesheet', href='/dist/#{config.buildPaths.lib.stylesheetMinified}')
    link(rel='stylesheet', href='/dist/#{config.buildPaths.app.stylesheetMinified}')
    
    block head
    
  body
    
    block body

    script(src='/dist/#{config.buildPaths.lib.javascriptMinified}')
    script(src='/dist/#{config.buildPaths.app.javascriptMinified}')
    
    block views
    